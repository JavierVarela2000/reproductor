var f=Object.defineProperty;var _=r=>{throw TypeError(r)};var g=(r,e,t)=>e in r?f(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var y=(r,e,t)=>g(r,typeof e!="symbol"?e+"":e,t),k=(r,e,t)=>e.has(r)||_("Cannot "+t);var s=(r,e,t)=>(k(r,e,"read from private field"),t?t.call(r):e.get(r)),a=(r,e,t)=>e.has(r)?_("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t);import{s as o,g as d,a as h,p as m}from"./AkqJN3-E.js";var n,l,u,c;class x{constructor(e=null){a(this,n,o(null));a(this,l,o(null));a(this,u,o(m({is_playing:!1,is_paused:!1,is_buffering:!1,is_seeking:!1,is_ended:!1})));y(this,"audio_player");a(this,c,o(null));e?this.audio_player=e:(typeof window>"u"&&console.warn("El entorno no tiene acceso a window. El reproductor de audio no se inicializará."),this.audio_player=new Audio,this.audio_player.volume=.5),this.audio_player.addEventListener("timeupdate",()=>{this.state.is_seeking||(this.current_time=this.audio_player.currentTime)}),this.audio_player.addEventListener("loadedmetadata",()=>{this.state={is_buffering:!0,is_playing:!1,is_paused:!1,is_seeking:!1,is_ended:!1}}),this.handleProgress=()=>{const t=this.audio_player.buffered,i=this.audio_player.duration;if(t.length>0&&i>0){const p=t.end(t.length-1)/i*100;p>=5&&!this.state.is_playing&&this.play(),p<100?this.current_buffered=p:(this.state.is_buffering=!1,this.audio_player.removeEventListener("progress",this.handleProgress))}},this.audio_player.addEventListener("progress",this.handleProgress)}get current_playlist(){return d(s(this,n))}set current_playlist(e){h(s(this,n),e,!0)}get current_track(){return d(s(this,l))}set current_track(e){h(s(this,l),e,!0)}get state(){return d(s(this,u))}set state(e){h(s(this,u),e,!0)}get current_time(){return d(s(this,c))}set current_time(e){h(s(this,c),e,!0)}play_track(e){this.current_track=e,this.audio_player.src=e.url,this.audio_player.load(),this.play()}play(){if(!this.current_track){console.error("No hay pista actual para reproducir.");return}this.audio_player.play().then(()=>{this.state={...this.state,is_playing:!0,is_paused:!1,is_seeking:!1}})}pause(){this.audio_player.pause(),this.state={...this.state,is_playing:!1,is_paused:!0}}next(){if(!this.current_playlist){console.error("No hay lista de reproducción actual.");return}if(this.current_playlist.tracks.length===0){console.warn("No hay pistas en la lista de reproducción.");return}const t=(this.current_playlist.tracks.findIndex(i=>i===this.current_track)+1)%this.current_playlist.tracks.length;this.play_track(this.current_playlist.tracks[t])}prev(){if(!this.audio_player){console.error("El reproductor de audio no está disponible.");return}if(!this.current_playlist){console.error("No hay lista de reproducción actual.");return}if(this.current_playlist.tracks.length===0){console.warn("No hay pistas en la lista de reproducción.");return}const t=(this.current_playlist.tracks.findIndex(i=>i===this.current_track)-1+this.current_playlist.tracks.length)%this.current_playlist.tracks.length;this.play_track(this.current_playlist.tracks[t])}seek(e){this.current_time=e,this.audio_player.currentTime=this.current_time}}n=new WeakMap,l=new WeakMap,u=new WeakMap,c=new WeakMap;const v=new x;export{v as p};
